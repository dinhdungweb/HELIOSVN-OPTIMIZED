{% comment %}
  Tier Badge Overlay for Product Card
  Shows tier discount badge on product image (top right corner)
  
  Parameters:
  - customer: Customer object
{% endcomment %}

{% liquid
  assign tier_discount = 0
  assign tier_name = ""
  assign has_tier = false
  assign total_spent = 0
  
  if customer
    if customer.metafields.custom.total_spent != blank and customer.metafields.custom.total_spent != 0
      assign total_spent = customer.metafields.custom.total_spent | plus: 0
    else
      assign total_spent = customer.total_spent | divided_by: 100
    endif
    
    if customer.tags contains "BLACK DIAMOND"
      assign tier_discount = 20
      assign tier_name = "BLACK DIAMOND"
      assign has_tier = true
    elsif customer.tags contains "DIAMOND"
      assign tier_discount = 15
      assign tier_name = "DIAMOND"
      assign has_tier = true
    elsif customer.tags contains "PLATINUM"
      assign tier_discount = 12
      assign tier_name = "PLATINUM"
      assign has_tier = true
    elsif customer.tags contains "GOLD"
      assign tier_discount = 10
      assign tier_name = "GOLD"
      assign has_tier = true
    elsif customer.tags contains "SILVER"
      assign tier_discount = 7
      assign tier_name = "SILVER"
      assign has_tier = true
    else
      if total_spent >= 100000000
        assign tier_discount = 20
        assign tier_name = "BLACK DIAMOND"
        assign has_tier = true
      elsif total_spent >= 20000000
        assign tier_discount = 15
        assign tier_name = "DIAMOND"
        assign has_tier = true
      elsif total_spent >= 10000000
        assign tier_discount = 12
        assign tier_name = "PLATINUM"
        assign has_tier = true
      elsif total_spent >= 6000000
        assign tier_discount = 10
        assign tier_name = "GOLD"
        assign has_tier = true
      elsif total_spent >= 3000000
        assign tier_discount = 7
        assign tier_name = "SILVER"
        assign has_tier = true
      elsif total_spent > 0
        assign tier_discount = 5
        assign tier_name = "MEMBER"
        assign has_tier = true
      endif
    endif
  endif
%}

TEST BADGE HERE
